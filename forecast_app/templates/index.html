{% extends "base.html" %}

{% load humanize %}

{% block title %}Welcome!{% endblock %}

{% block content %}

    <h1>Forecast Repository Home</h1>

    <p>
        <img width="50%" src="http://reichlab.io/images/blog/flusight-wide.png" class="pull-right">
        Welcome to the <a href="http://reichlab.io/">Reichlab</a> <em>Forecast Repository</em>, a web application to
        prototype our ideas for a repository of model forecast results along with tools to compare, etc. The main
        ideas are outlined on the <a href="{% url 'about' %}">About</a> page.
    </p>


    <h2>Users</h2>

    {% if users %}
        <p>The repository has {{ users|length }} user{{ users|length|pluralize }}:</p>
        <p>todo xx project/model counts for each</p>
        <ul>
            {% for user in users %}
                <li><a href="{% url 'user-detail' user.pk %}">{{ user.username }}</a></li>
            {% endfor %}
        </ul>
    {% else %}
        <p>There are no users in the repository.</p>
    {% endif %}


    <h2>Projects</h2>

    {% if projects %}
        <p>The repository has {{ projects|length }} project{{ projects|length|pluralize }}:</p>
        <table class="table table-striped table-bordered">
            <tr>
                <th>Project</th>
                <th>Owner</th>
                <th>Description</th>
                <th>Objects</th>
            </tr>
            {% for project in projects|dictsort:"name" %}
                <tr>
                    <td>
                        <a href="{% url 'project-detail' project.pk %}">{{ project.name }}</a>
                    </td>
                    <td><a href="{% url 'user-detail' project.owner.pk %}">{{ project.owner.username }}</a></td>
                    <td>{{ project.description }}</td>
                    <td class="text-muted">{{ project.get_summary_counts.0 }} models,
                        {{ project.get_summary_counts.1 }} forecasts,
                        {{ project.get_summary_counts.2|intcomma }} rows
                    </td>
                </tr>
            {% endfor %}
        </table>


    {% else %}
        <p>There are no projects in the repository.</p>
    {% endif %}

{% endblock %}
