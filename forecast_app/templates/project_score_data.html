{% extends "base.html" %}

{% block title %}Project Score Data: {{ project.name }}{% endblock %}

{% block content %}

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'projects' %}">Home</a></li>
            <li class="breadcrumb-item"><a href="{{ project.get_absolute_url }}">{{ project.name }}</a></li>
            <li class="breadcrumb-item active">Score data</li>
        </ol>
    </nav>


    <h4>Scores (all models)</h4>

    {% if score_summaries %}
        <table id="score_summaries_table" class="table table-striped table-bordered">
            <thead>
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Last Update</th>
                <th># Score Values</th>
            </tr>
            </thead>
            <tbody>
            {% for score, num_score_values, last_update in score_summaries %}
                <tr>
                    <td>{{ score.name }}</td>
                    <td>{{ score.description }}</td>
                    <td>{{ last_update.updated_at }}</td>
                    <td>{{ num_score_values }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>
            <small class="text-muted">(No scores defined)</small>
        </p>
    {% endif %}

    <form id="download_form" class="form-inline" method="POST" action="{% url 'download-project-scores' project.pk %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-success"
                {% if not project.score_csv_file_cache.is_file_exists %}disabled{% endif %}>Download CSV</button>
        {% if project.score_csv_file_cache.is_file_exists %}
            <span class="text-muted"> (Cached file updated
                {{ project.score_csv_file_cache.updated_at|date:"Y-m-d h:i:s T" }})</span>
        {% else %}
            <span class="text-muted">&nbsp(No cached file to download.)</span>
        {% endif %}
    </form>


    <!-- activate the https://datatables.net/ -->
    <script>
        $(document).ready(function () {
            $('#score_summaries_table').DataTable();
        });
    </script>

{% endblock %}
